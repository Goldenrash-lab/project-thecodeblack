{"mappings":"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","sources":["src/js/cart.js"],"sourcesContent":["import '../../node_modules/modern-normalize/modern-normalize.css';\nimport './templates/footer-validation';\nimport './templates/footer-postApi';\n\n// CART VALUE\n\nconst spanCasa = document.querySelector('.css-span-casa');\n\ndocument.addEventListener('DOMContentLoaded', onDocumentLoad);\n\nfunction onDocumentLoad() {\n  const obj = loadToLS('cartIds');\n  if (!obj.length) {\n    spanCasa.innerHTML = `CART(0)`;\n  }\n  spanCasa.innerHTML = `CART(${obj.length})`;\n}\n\n// Связываем элементы и переменные\nconst refs = {\n  cartHeading: document.querySelector('#cart-heading'),\n  productList: document.querySelector('#cart-product-list'),\n  warningContainer: document.querySelector('#warning-container'),\n  baseContainer: document.querySelector('#cart-base-container'),\n  closeButton: document.querySelector('.close-button'),\n  deleteAllBtn: document.querySelector('#button-wrapper'),\n  totalWrapper: document.querySelector('#total-wrapper'),\n};\n\n//достаём данные из local storage\nconst cartIdsData = localStorage.getItem('cartIds');\nconst cartIdsArray = JSON.parse(cartIdsData);\nfetchCartProducts(cartIdsArray);\n\n//функция запроса данных\nfunction fetchCartProducts(cartIds) {\n  const BASE_URL = 'https://food-boutique.b.goit.study/api/products';\n\n  Promise.all(\n    cartIds.map(productId => {\n      const url = `${BASE_URL}/${productId}`;\n\n      return fetch(url)\n        .then(response => {\n          if (!response.ok) {\n            throw new Error(`Ошибка HTTP: ${response.status}`);\n          }\n          return response.json();\n        })\n        .catch(error => {\n          console.error('Ошибка при выполнении запроса:', error);\n          throw error;\n        });\n    })\n  )\n    .then(productsData => {\n      scrollAdding(productsData.length);\n      cartLargeNumber(productsData.length);\n      renderProductsCart(productsData);\n      countTotalPrice(productsData);\n      console.log(productsData);\n    })\n    .catch(error => {\n      console.error('Ошибка при выполнении запросов:', error);\n    });\n}\n\n// Создаем шаблон элемента и выводим его на страницу\nfunction renderProductsCart(products) {\n  const markup = products\n    .map(el => {\n      const { category, img, name, price, size, _id } = el;\n\n      return `<li class=\"product-item\" data-productId=\"${_id}\">\n            <img\n              class=\"product-item-img\"\n              src=\"${img}\"\n              alt=\"\"\n            />\n\n            <div class=\"product-item-content\">\n              <div class=\"characteristic-wrapper\">\n                <h3 class=\"product-item-heading product-bold\">${name}</h3>\n                <div class=\"charactetistic-text-container\">\n                  <span class=\"product-item-text\">\n                    <span class=\"key-span\">Category:</span>\n                    ${category}\n                  </span>\n                  <span class=\"product-item-text\">\n                    <span class=\"key-span\">Size:</span>\n                    ${size}\n                  </span>\n                </div>\n              </div>\n\n              <p class=\"product-price\">&#36;${price}</p>\n            </div>\n            <button type=\"button\" class=\"close-button product-bold\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"close-icon\" width=\"16\" height=\"16\" viewBox=\"0 0 12 12\" fill=\"none\">\n                    <path d=\"M11.0625 2.11488L9.88512 0.9375L6 4.82262L2.11488 0.9375L0.9375 2.11488L4.82262 6L0.9375 9.88512L2.11488 11.0625L6 7.17738L9.88512 11.0625L11.0625 9.88512L7.17738 6L11.0625 2.11488Z\" fill=\"#010101\"/>\n                </svg>\n              </button>\n          </li>`;\n    })\n    .join('');\n\n  return (refs.productList.innerHTML = markup);\n}\n\n// функция для вывода данных в счетчик в заголовке страницы\nfunction cartLargeNumber(cartLargeNumber) {\n  if (cartLargeNumber === 0) {\n    refs.warningContainer.classList.remove('visually-hidden');\n    refs.baseContainer.classList.add('visually-hidden');\n  }\n\n  refs.cartHeading.innerHTML = `CART (${cartLargeNumber})`;\n}\n\n// подсчет общей суммы\nfunction countTotalPrice(priceArray) {\n  let totalPrice = 0;\n\n  priceArray.map(el => {\n    return (totalPrice += el.price);\n  });\n\n  return (refs.totalWrapper.innerHTML = `\n        <span class=\"key-span\">Sum:</span>\n        <span class=\"price-text\">&#36;${totalPrice.toFixed(2)}</span>\n    `);\n}\n\n// функция для удаления одного элемента\nfunction clickDeleteElBtn(event) {\n  const btn = event.target.closest('.close-button');\n  if (!btn) {\n    return;\n  }\n  const element = btn.parentElement;\n  const productId = element.getAttribute('data-productid');\n\n  btn.parentElement.remove();\n\n  updateLocalStorage(productId);\n  const obj = loadToLS('cartIds');\n  spanCasa.innerHTML = `CART(${obj.length})`;\n}\n\n//Удаляем все элементы списка по нажатию на кнопку Delete All\nfunction clickDeleteAllBtn() {\n  refs.cartHeading.innerHTML = 'CART (0)';\n  refs.warningContainer.classList.remove('visually-hidden');\n  refs.baseContainer.innerHTML = '';\n  localStorage.setItem('cartIds', JSON.stringify([]));\n  const obj = loadToLS('cartIds');\n  spanCasa.innerHTML = `CART(${obj.length})`;\n}\n\n// дополнительная функция для обновления local storage после удаления элемента\nfunction updateLocalStorage(elementToRemove) {\n  const cartIdsData = localStorage.getItem('cartIds');\n  const cartIdsArray = JSON.parse(cartIdsData);\n  console.log(cartIdsArray);\n\n  const updatedCartIds = cartIdsArray.filter(id => id !== elementToRemove);\n  localStorage.setItem('cartIds', JSON.stringify(updatedCartIds));\n  cartLargeNumber(updatedCartIds.length);\n\n  fetchCartProducts(updatedCartIds);\n}\n\n// Добавляем скролл, когда 3 элемента и больше\nfunction scrollAdding(listLength) {\n  if (listLength > 3 && window.innerWidth >= 768) {\n    refs.productList.classList.add('scroll-adding');\n  }\n}\n\n// Добавляем слушателей событий на список и на кнопку полного удаления\nrefs.productList.addEventListener('click', clickDeleteElBtn);\nrefs.deleteAllBtn.addEventListener('click', clickDeleteAllBtn);\n\nexport function saveToLS(key, value) {\n  try {\n    localStorage.setItem(key, JSON.stringify(value));\n  } catch (error) {\n    console.log(error.message);\n  }\n}\nexport function loadToLS(key) {\n  try {\n    return JSON.parse(localStorage.getItem(key)) || {};\n  } catch (error) {\n    console.log(error.message);\n    return localStorage.getItem(key);\n  }\n}\n"],"names":["$915de8ffc4dd3149$var$spanCasa","document","querySelector","addEventListener","obj","$915de8ffc4dd3149$export$5b58afb9966d95d6","length","innerHTML","$915de8ffc4dd3149$var$refs","cartHeading","productList","warningContainer","baseContainer","closeButton","deleteAllBtn","totalWrapper","$915de8ffc4dd3149$var$cartIdsData","localStorage","getItem","$915de8ffc4dd3149$var$fetchCartProducts","cartIds","Promise","all","map","productId","fetch","then","response","ok","Error","status","json","catch","error","console","productsData","window","innerWidth","classList","add","$915de8ffc4dd3149$var$cartLargeNumber","products","markup","el","category","img","name","price","size","_id","join","$915de8ffc4dd3149$var$renderProductsCart","priceArray","totalPrice","toFixed","$915de8ffc4dd3149$var$countTotalPrice","log","cartLargeNumber1","remove","key","JSON","parse","message","event","btn","target","closest","parentElement","getAttribute","elementToRemove","cartIdsData1","cartIdsArray1","updatedCartIds","filter","id","setItem","stringify","$915de8ffc4dd3149$var$updateLocalStorage"],"version":3,"file":"cart.80cc8e21.js.map"}