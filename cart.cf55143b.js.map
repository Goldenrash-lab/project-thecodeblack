{"mappings":"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","sources":["src/js/cart.js","src/js/templates/cart-postApi.js","src/js/templates/cart-validation.js"],"sourcesContent":["import axios from 'axios';\nimport '../../node_modules/modern-normalize/modern-normalize.css';\nimport './templates/footer-validation';\nimport './templates/footer-postApi';\nimport './templates/cart-postApi';\nimport './templates/cart-validation';\n\n// CART VALUE\n\nconst spanCasa = document.querySelector('.css-span-casa');\nconst loaderEl = `<div class=\"loader\"></div>`;\n\nfunction onDocumentLoad() {\n  const obj = loadToLS('cartIds');\n  if (!Object.keys(obj).length) {\n    spanCasa.innerHTML = `CART(0)`;\n  } else {\n    spanCasa.innerHTML = `CART(${Object.keys(obj).length})`;\n  }\n}\n\n// Связываем элементы и переменные\nconst refs = {\n  cartHeading: document.querySelector('#cart-heading'),\n  productList: document.querySelector('#cart-product-list'),\n  warningContainer: document.querySelector('#warning-container'),\n  baseContainer: document.querySelector('#cart-base-container'),\n  closeButton: document.querySelector('.close-button'),\n  deleteAllBtn: document.querySelector('#button-wrapper'),\n  totalWrapper: document.querySelector('#total-wrapper'),\n};\n\n//достаём данные из local storage\n// const cartIdsData = localStorage.getItem('cartIds');\n//\nconst cartIdsArray = loadToLS('cartIds');\ngetCartProducts(cartIdsArray);\n\n//функция запроса данных\nfunction getCartProducts(cartIds) {\n  const BASE_URL = 'https://food-boutique.b.goit.study/api/products';\n  refs.productList.innerHTML = loaderEl;\n  refs.productList.classList.add('load-discount');\n  refs.totalWrapper.innerHTML = loaderEl;\n  refs.totalWrapper.classList.add('load-total');\n  Promise.all(\n    // *****\n    Object.keys(cartIds).map(productId => {\n      return axios\n        .get(`${BASE_URL}/${productId}`)\n        .then(response => {\n          if (!response.data) {\n            throw new Error(`Ошибка HTTP: ${response.status}`);\n          }\n          return response.data;\n        })\n        .catch(error => {\n          console.error('Ошибка при выполнении запроса:', error);\n          throw error;\n        });\n    })\n  )\n    .then(productsData => {\n      scrollAdding(productsData.length);\n      cartLargeNumber(productsData.length);\n      renderProductsCart(productsData);\n      countTotalPrice(productsData);\n      refs.productList.classList.remove('load-discount');\n    })\n    .catch(error => {\n      console.error('Ошибка при выполнении запросов:', error);\n    });\n}\n\n// Создаем шаблон элемента и выводим его на страницу\nfunction renderProductsCart(products) {\n  const markup = products\n    .map(el => {\n      const { category, img, name, price, size, _id } = el;\n\n      return `<li class=\"product-item\" data-productId=\"${_id}\">\n            <div class=\"product-img-wrapper\">\n              <img\n              class=\"product-item-img\"\n              src=\"${img}\"\n              alt=\"${name}\"\n              loading=\"lazy\"\n            />\n            </div>\n\n            <div class=\"product-item-content\">\n              <div class=\"characteristic-wrapper\">\n                <h3 class=\"product-item-heading product-bold\">${name}</h3>\n                <div class=\"charactetistic-text-container\">\n                  <span class=\"product-item-text\">\n                    <span class=\"key-span\">Category:</span>\n                    ${category}\n                  </span>\n                  <span class=\"product-item-text\">\n                    <span class=\"key-span\">Size:</span>\n                    ${size}\n                  </span>\n                </div>\n              </div>\n\n              <p class=\"product-price\">&#36;${price}</p>\n            </div>\n            <button type=\"button\" class=\"close-button product-bold\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"close-icon\" width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"none\">\n                    <path d=\"M11.0625 2.11488L9.88512 0.9375L6 4.82262L2.11488 0.9375L0.9375 2.11488L4.82262 6L0.9375 9.88512L2.11488 11.0625L6 7.17738L9.88512 11.0625L11.0625 9.88512L7.17738 6L11.0625 2.11488Z\" fill=\"#010101\"/>\n                </svg>\n              </button>\n\n            <div class=\"counter__wrapper\">\n              <button class=\"counter__btn\" type=\"button\" data-action=\"decrement\"> - </button>\n              <span class=\"counter__value\">1</span>\n              <button class=\"counter__btn\" type=\"button\" data-action=\"increment\"> + </button>\n            </div>\n\n          </li>`;\n    })\n    .join('');\n\n  return (refs.productList.innerHTML = markup);\n}\n\n// функция для вывода данных в счетчик в заголовке страницы\nfunction cartLargeNumber(cartLargeNumber) {\n  if (cartLargeNumber === 0) {\n    refs.warningContainer.classList.remove('visually-hidden');\n    refs.baseContainer.classList.add('visually-hidden');\n  }\n\n  refs.cartHeading.innerHTML = `CART (${cartLargeNumber})`;\n}\n\n// подсчет общей суммы\nfunction countTotalPrice(priceArray) {\n  let totalPrice = 0;\n\n  priceArray.forEach(product => {\n    return (totalPrice += product.price);\n  });\n\n  return (refs.totalWrapper.innerHTML = `\n        <span class=\"key-span\">Sum:</span>\n        <span class=\"price-text\">&#36;${totalPrice.toFixed(2)}</span>\n    `);\n}\n\n// функция для удаления одного элемента\nfunction clickDeleteElBtn(event) {\n  const btn = event.target.closest('.close-button');\n  if (!btn) {\n    return;\n  }\n  const element = btn.parentElement;\n  const productId = element.getAttribute('data-productid');\n\n  btn.parentElement.remove();\n\n  updateLocalStorage(productId);\n  const obj = loadToLS('cartIds');\n  spanCasa.innerHTML = `CART(${Object.keys(obj).length})`;\n}\n\n//Удаляем все элементы списка по нажатию на кнопку Delete All\nfunction clickDeleteAllBtn() {\n  refs.cartHeading.innerHTML = 'CART (0)';\n  refs.warningContainer.classList.remove('visually-hidden');\n  refs.baseContainer.innerHTML = '';\n  // ***\n  // localStorage.setItem('cartIds', JSON.stringify([]));\n  localStorage.setItem('cartIds', JSON.stringify({}));\n  const obj = loadToLS('cartIds');\n  spanCasa.innerHTML = `CART(${Object.keys(obj).length})`;\n}\n\n// дополнительная функция для обновления local storage после удаления элемента\nfunction updateLocalStorage(elementToRemove) {\n  // const cartIdsData = localStorage.getItem('cartIds');\n  // const cartIdsArray = JSON.parse(cartIdsData);\n  const cartIdsArray = loadToLS('cartIds');\n\n  delete cartIdsArray[elementToRemove];\n\n  // const updatedCartIds = Object.keys(cartIdsArray).filter(id => id !== elementToRemove);\n  // localStorage.setItem('cartIds', JSON.stringify(updatedCartIds));\n  saveToLS('cartIds', cartIdsArray);\n  cartLargeNumber(Object.keys(cartIdsArray).length);\n\n  getCartProducts(cartIdsArray);\n}\n\n// Добавляем скролл, когда 3 элемента и больше\nfunction scrollAdding(listLength) {\n  if (listLength > 3) {\n    refs.productList.classList.add('scroll-adding');\n  }\n}\n\n// Добавляем слушателей событий на список и на кнопку полного удаления\n\ndocument.addEventListener('DOMContentLoaded', onDocumentLoad);\nrefs.productList.addEventListener('click', clickDeleteElBtn);\nrefs.deleteAllBtn.addEventListener('click', clickDeleteAllBtn);\n\n// экспорт функций\nexport function saveToLS(key, value) {\n  try {\n    localStorage.setItem(key, JSON.stringify(value));\n  } catch (error) {\n    console.log(error.message);\n  }\n}\nexport function loadToLS(key) {\n  try {\n    return JSON.parse(localStorage.getItem(key)) || {};\n  } catch (error) {\n    console.log(error.message);\n    return localStorage.getItem(key);\n  }\n}\n\n/**\n  |============================\n  | COUNTER\n  |============================\n*/\n\nrefs.productList.addEventListener('click', e => {\n  const target = e.target;\n\n  if (target.classList.contains('counter__btn')) {\n    const cartItem = target.closest('.product-item');\n\n    const counterValue = cartItem.querySelector('.counter__value');\n    const counterAction = target.getAttribute('data-action');\n    const id = cartItem.dataset.productid;\n\n    const localStorageItemParse = loadToLS('cartIds');\n    let counter = parseInt(counterValue.textContent);\n\n    if (counterAction === 'increment') {\n      counter += 1;\n    } else if (counterAction === 'decrement' && counter > 1) {\n      counter -= 1;\n    }\n\n    counterValue.textContent = counter;\n\n    if (Object.keys(localStorageItemParse).includes(id)) {\n      localStorageItemParse[id] = counter;\n\n      saveToLS('cartIds', localStorageItemParse);\n    }\n\n    recalculateTotalPrice();\n  }\n});\n\nfunction recalculateTotalPrice() {\n  const productsInCart = Array.from(\n    refs.productList.querySelectorAll('.product-item')\n  );\n\n  let totalPrice = 0;\n  let totalCartQuantity = 0;\n\n  productsInCart.forEach(productEl => {\n    const quantity = parseInt(\n      productEl.querySelector('.counter__value').textContent\n    );\n    const price = parseFloat(\n      productEl.querySelector('.product-price').textContent.replace('$', '')\n    );\n    totalPrice += price * quantity;\n\n    totalCartQuantity += quantity;\n    // spanCasa.textContent = `Cart(${totalCartQuantity})`;\n    // refs.cartHeading.innerHTML = `Cart(${totalCartQuantity})`;\n  });\n\n  refs.totalWrapper.innerHTML = `\n        <span class=\"key-span\">Sum:</span>\n        <span class=\"price-text\">&#36;${totalPrice.toFixed(2)}</span>\n    `;\n}\n\nexport { clickDeleteAllBtn };\n","import axios from 'axios';\nimport Notiflix, { Notify } from 'notiflix';\n\naxios.defaults.baseURL = 'https://food-boutique.b.goit.study/api';\n\nconst makeCheckout = savedOrder => {\n  return axios\n    .post('/orders', savedOrder)\n    .then(response => {\n      Notiflix.Notify.success(\n        'Order Success! Thank you for shopping at Food Boutique. Your order has been received and is now being freshly prepared just for you! Get ready to indulge in nourishing goodness, delivered right to your doorstep. We re thrilled to be part of your journey to better health and happiness. 🌿🍎'\n      );\n    })\n    .catch(err => {\n      console.log(err);\n    });\n};\n\nexport { makeCheckout };\n","import throttle from 'lodash.throttle';\nimport { makeCheckout } from './cart-postApi';\nimport { clickDeleteAllBtn } from '../cart';\n\nconst cartForm = document.querySelector('.form-wrapper');\n\nconst STORAGE_KEY = 'order';\nlet order = {\n  email: '',\n  products: [\n    {\n      productId: '',\n      amount: '',\n    },\n  ],\n};\n\nconst makeOrder = () => {\n  const cartIdsData = JSON.parse(localStorage.getItem('cartIds'));\n  order.products = cartIdsData.map(id => {\n    const amount = document.querySelector(\n      `[data-productid=\"${id}\"] .counter__value`\n    ).textContent;\n    return { productId: id, amount: +amount };\n  });\n  return order;\n};\n\nlet value = '';\n\ncartForm.addEventListener('input', throttle(onEmailInput, 400));\n\nconst userEmail = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};\n\nfunction onEmailInput(e) {\n  userEmail[e.target.name] = e.target.value;\n  value = e.target.value;\n  order.email = value;\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(order));\n}\n\ncartForm.addEventListener('submit', onCheckout);\n\nfunction onCheckout(e) {\n  e.preventDefault();\n  makeOrder();\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(order));\n  const savedOrder = JSON.parse(localStorage.getItem(STORAGE_KEY));\n  e.currentTarget.reset();\n  localStorage.removeItem(STORAGE_KEY);\n  makeCheckout(savedOrder);\n  clickDeleteAllBtn();\n}\n"],"names":["$dIxxU","parcelRequire","default","defaults","baseURL","$53d75c756e064705$export$ccc883122007ba34","savedOrder","post","then","response","$parcel$interopDefault","$6JpON","Notify","success","catch","err","console","log","$dCfNN","$3ac10f45063dbf7c$var$cartForm","document","querySelector","$3ac10f45063dbf7c$var$STORAGE_KEY","$3ac10f45063dbf7c$var$order","email","products","productId","amount","$3ac10f45063dbf7c$var$value","addEventListener","e","$3ac10f45063dbf7c$var$userEmail","target","name","value","localStorage","setItem","JSON","stringify","parse","getItem","preventDefault","cartIdsData","map","id","textContent","$3ac10f45063dbf7c$var$makeOrder","currentTarget","reset","removeItem","$ce375e1befa17f1c$export$349050602dcd5ac2","$ce375e1befa17f1c$var$spanCasa","$ce375e1befa17f1c$var$loaderEl","$ce375e1befa17f1c$var$refs","cartHeading","productList","warningContainer","baseContainer","closeButton","deleteAllBtn","totalWrapper","$ce375e1befa17f1c$var$getCartProducts","cartIds","innerHTML","classList","add","Promise","all","Object","keys","get","data","Error","status","error","productsData","length","$ce375e1befa17f1c$var$cartLargeNumber","markup","el","category","img","price","size","_id","join","$ce375e1befa17f1c$var$renderProductsCart","priceArray","totalPrice","forEach","product","toFixed","$ce375e1befa17f1c$var$countTotalPrice","remove","cartLargeNumber1","obj","$ce375e1befa17f1c$export$5b58afb9966d95d6","$ce375e1befa17f1c$export$53c15ea6e761c354","key","message","event","btn","closest","parentElement","getAttribute","elementToRemove","cartIdsArray1","$ce375e1befa17f1c$var$updateLocalStorage","contains","cartItem","counterValue","counterAction","dataset","productid","localStorageItemParse","counter","parseInt","includes","productsInCart","Array","from","querySelectorAll","totalCartQuantity","productEl","quantity","parseFloat","replace","$ce375e1befa17f1c$var$recalculateTotalPrice"],"version":3,"file":"cart.cf55143b.js.map"}